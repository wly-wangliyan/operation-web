<div class="content-header">
  <app-crumb [level1Name]="'配件库'" [level2Name]=""></app-crumb>
  <ul class="header-right">
    <li class="big-bg" [routerLink]="['../edit']">
      <a>创建</a>
    </li>
  </ul>
</div>
<div class="content-flow">
  <div class="table-container">
    <div class="search-container">
      <form nz-form class="search-form">
        <div nz-row class="search_row">
          <div>
            <nz-form-item nzFlex>
              <nz-form-label>所属项目</nz-form-label>
              <nz-form-control class="form_control">
                <select class="form-control" name="pay_status" [(ngModel)]="searchParams.pay_status">
                  <option value="">全部</option>
                  <option value="1">未支付</option>
                  <option value="2">已支付</option>
                  <option value="3">已完成</option>
                </select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div>
            <nz-form-item nzFlex>
              <nz-form-label>配件品牌</nz-form-label>
              <nz-form-control class="form_control">
                <select class="form-control" name="upkeep_item_category"
                  [(ngModel)]="searchParams.upkeep_item_category">
                  <option value="">全部</option>
                  <option value="1">保养项目</option>
                  <option value="2">清洗养护项目</option>
                  <option value="3">维修项目</option>
                </select>
              </nz-form-control>
            </nz-form-item>
          </div>
          <div>
            <nz-form-item nzFlex>
              <nz-form-label>配件名称</nz-form-label>
              <nz-form-control>
                <input class="form-control" placeholder="请输入手机号" autocomplete="off"
                  [(ngModel)]="searchParams.payer_phone" name="payer_phone" maxlength='11' />
              </nz-form-control>
            </nz-form-item>
          </div>
          <div>
            <nz-form-item nzFlex>
              <nz-form-label>ID</nz-form-label>
              <nz-form-control>
                <input class="form-control" placeholder="请输入购买人" autocomplete="off"
                  [(ngModel)]="searchParams.payer_name" name="payer_name" maxlength='20' />
              </nz-form-control>
            </nz-form-item>
          </div>
          <div class='search_btn'>
            <button nz-button nzType="primary" (click)="onSearchBtnClick()">
              查询</button>
          </div>
        </div>
      </form>
    </div>
    <div class="zmy-table">
      <nz-table [nzData]="orderList" [nzShowPagination]="true" [nzNoResult]="noResultText" [nzPageSize]="'15'"
        (nzPageIndexChange)="onNZPageIndexChange($event)" [(nzPageIndex)]="pageIndex" #basicTable>
        <thead>
          <tr>
            <th>序号</th>
            <th>ID</th>
            <th>配件信息</th>
            <th>所属项目</th>
            <th>配件品牌</th>
            <th>原价</th>
            <th>售价</th>
            <th>结算价</th>
            <th>销量</th>
            <th>状态</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data; let i=index">
            <td>{{i+(pageIndex-1)*15+1}}</td>
            <td [title]='data.upkeep_order_id'>{{(data.upkeep_order_id|zMaxLength:5)||'--'}}</td>
            <td [title]='data.payer_name'>{{(data.payer_name|zMaxLength:3)||'--'}}</td>
            <td>{{data.payer_phone||'--'}}</td>
            <td>{{data.vehicle_brand_name||'--'}}</td>
            <td
              [title]="data.vehicle_firm_name+' '+data.vehicle_series_name+' '+data.vehicle_year_model+' '+data.vehicle_type_name">
              {{(data.vehicle_firm_name+' '+data.vehicle_series_name+' '+data.vehicle_year_model+' '+data.vehicle_type_name)|zMaxLength:4}}
            </td>
            <td [title]='data.upkeep_merchant_name'>{{(data.upkeep_merchant_name|zMaxLength:4)||'--'}}</td>
            <td *ngIf='data.item_categorys&&data.item_categorys.length!==0'>
              <span *ngFor="let obj of data.item_categorys;let idx=index; "> {{obj|projectCategory}}<span
                  *ngIf='(idx+1)!==data.item_categorys.length'>; </span> </span>
            </td>
            <td *ngIf='!data.item_categorys||data.item_categorys.length===0'>--</td>
            <td>{{data.upkeep_item_category_count||'--'}}</td>
            <td>{{(data.total_real_amount | zCompleteNumber)||0}} 元</td>
            <td>{{data.pay_time?(data.pay_time* 1000 | date:"y-MM-dd HH:mm"):'--'}}</td>
            <td>{{data.reserve_time?(data.reserve_time* 1000 | date:"y-MM-dd HH:mm"):'--'}}</td>
            <td style='min-width: 70px;'>{{data.pay_status|storePayStatus}}</td>
            <td class="operation">
              <a [title]="'编辑'" [routerLink]="['../order-detail',data.upkeep_order_id]">编辑</a>
              <a [title]="'推荐设置'" (click)="onOpenBrandFirmModal()">推荐设置</a>
              <a [title]="'删除'" (click)="onDeleteAccessory(data)">删除</a>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </div>
  </div>
</div>
<!-- 设置推荐车系 -->
<app-select-multi-brand-firm></app-select-multi-brand-firm>