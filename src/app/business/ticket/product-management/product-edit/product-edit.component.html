<div class="content-header">
  <!-- <app-crumb [level1Name]="'产品管理'" [level1RelativePath]="'../'" [level2Name]="'编辑产品'"></app-crumb> -->
  <!-- <a [routerLink]="['/product_management']">产品管理</a>
  <span> 》编辑产品</span> -->
  <div class="header-left">
    <i></i>
    <a [routerLink]="['../']">产品管理</a>
    <span> >><span class='second-crumb'>编辑产品</span></span>
  </div>
  <ul class="header-right">
    <li class="big-bg big-white-btn">
      <a [routerLink]="['../']">返回</a>
    </li>
    <li class="big-bg">
      <a (click)='onSaveFormData()'>保存</a>
    </li>
  </ul>
</div>
<div class="content-flow">
  <div class='des_card'>
    <div class='card-title'>产品信息</div>
    <div>
      <nz-table #thirdProductInfoTable [nzData]="thirdProductInfoList" [nzShowPagination]="false"
        [nzNoResult]="noResultInfoText" nzBordered>
        <thead>
          <tr>
            <th>产品主图</th>
            <th>产品名称</th>
            <th>地址</th>
            <th>状态</th>
            <th>产品ID</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of thirdProductInfoTable.data; let i=index">
            <td>
              <img *ngIf='!data.third_product_image' src="/assets/images/pro_default.png">
              <img *ngIf='data.third_product_image' [src]="data.third_product_image">
            </td>
            <td>{{data.third_product_name}}</td>
            <td>{{data.third_address}}</td>
            <td>{{data.sale_status}}</td>
            <td>{{data.third_product_id}}</td>
          </tr>
        </tbody>
      </nz-table>
    </div>
    <!-- 产品运营信息 -->
    <div class='card-title mt_50'>产品运营信息</div>
    <div>
      <form nz-form class="content-layout" #productInfoForm="ngForm">
        <div class="card_content">
          <nz-form-item nzFlex>
            <nz-form-label nzRequired [nzNoColon]='true'>产品名称</nz-form-label>
            <nz-form-control>
              <input class="main-title" [(ngModel)]="this.thirdProductData.third_product_name" placeholder="输入1-20字产品名称"
                nz-input autocomplete="off" name="main-title" required maxlength='20' />
            </nz-form-control>
          </nz-form-item>
          <nz-form-item nzFlex>
            <nz-form-label class="ml_10" [nzNoColon]='true'>副标题</nz-form-label>
            <nz-form-control class="ml_-10">
              <input class="subheading" [(ngModel)]="this.thirdProductData.introduce" placeholder=" 输入0-80字副标题" nz-input
                autocomplete="off" name="subheading" maxlength='80' />
            </nz-form-control>
          </nz-form-item>
        </div>
      </form>
    </div>

    <!-- 产品门票信息 -->
    <div class='card-title mt_50'>产品门票信息</div>
    <div>
      <nz-table #thirdProductTicketTable [nzData]="this.thirdProductData.tickets" [nzShowPagination]="false"
        [nzNoResult]="noResultTicketText" [nzFrontPagination]='false' nzBordered>
        <thead>
          <tr>
            <th>门票名称</th>
            <th>购票须知</th>
            <th>市场价</th>
            <th>建议零售价</th>
            <th>结算价</th>
            <th>售价</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of thirdProductTicketTable.data; let i=index">
            <td>
              <img *ngIf='data.is_top===1' class='top-img' src="/assets/images/top_icon.png">
              <span class='name'>{{data.ticket_name}}</span>
            </td>
            <td class='insutructions'>
              <div class='text' *ngIf='!data.isShowInsutructions'>
                <p>{{(data.notes)|zMaxLength:20}}</p>
                <span (click)='onShowInsutructions(i)'>展开</span>
              </div>
              <div class='text' *ngIf='data.isShowInsutructions'>
                <p>{{data.notes}}</p>
                <span (click)='onHideInsutructions(i)'>收起</span>
              </div>
            </td>
            <td>{{data.market_price}}</td>
            <td>{{data.retail_price}}</td>
            <td>{{data.buy_price}}</td>
            <td>{{data.price}}</td>
            <td class="opera">
              <a *ngIf='data.is_top===2' (click)='onIsTopProduct(data.product.product_id,2)'>置顶</a>
              <a *ngIf='data.is_top===1' (click)='onIsTopProduct(data.product.product_id,1)'>取消置顶</a>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </div>
    <!-- 票务详情 -->
    <div class='mt_50'><span class='card-title'>票务详情</span><a class='import-btn' (click)='onReImportData()'>重新导入</a>
    </div>
    <div>
      <form nz-form class="content-layout" #ticketDetailForm="ngForm">
        <div class="card_content">
          <nz-form-item nzFlex>
            <nz-form-label nzRequired [nzNoColon]='true'>产品图片</nz-form-label>
            <nz-form-control>
              <!-- <app-z-photo-select #productImg [hasAddPicture]="true" [hasDeletePicture]="true" [limitImgSize]="2"
                [isCutCoverImg]="true" [maxLength]="6" (selectedImgChange)="onSelectedPicture($event)"
                file_id="productImg" [imageWidth]='100' [imageHeight]='100' [imageUrls]="cover_url"
                [imageAddHeight]="100" [minCropBoxWidth]="400" [minCropBoxHeight]="400">
              </app-z-photo-select> -->
              <div *ngIf="errPositionItem?.icon?.isError" class="text-danger" style='margin-top: -14px;'>
                <span class="input-error input_time_valid">{{ errPositionItem?.icon?.errMes}}</span>
              </div>
              <div>注：图片比例为1:1，格式PNG或JPG，大小2M以内，图片名称只支持中文或数字，最多上传6张</div>
            </nz-form-control>
          </nz-form-item>
          <nz-form-item nzFlex>
            <nz-form-label class="ml_10" [nzNoColon]='true'>营业时间</nz-form-label>
            <nz-form-control class="ml_-10">
              <input class="detail-input" [(ngModel)]="this.thirdProductData.run_time" nz-input autocomplete="off"
                name="run_time" required maxlength='20' disabled />
            </nz-form-control>
          </nz-form-item>
          <nz-form-item nzFlex>
            <nz-form-label class="ml_10" [nzNoColon]='true'>联系电话</nz-form-label>
            <nz-form-control class="ml_-10">
              <input class="detail-input" [(ngModel)]="this.thirdProductData.telephone" nz-input autocomplete="off"
                name="telephone" required maxlength='12' disabled />
            </nz-form-control>
          </nz-form-item>
          <nz-form-item nzFlex>
            <nz-form-label class="ml_10" [nzNoColon]='true'>地址</nz-form-label>
            <nz-form-control class="ml_-10">
              <input class="address" nz-input [(ngModel)]="this.thirdProductData.provice" autocomplete="off"
                name="provice" placeholder="省" disabled />
              <input class="address" nz-input [(ngModel)]="this.thirdProductData.city" autocomplete="off" name="city"
                placeholder="市" disabled />
              <input class="address" nz-input [(ngModel)]="this.thirdProductData.district" autocomplete="off"
                name="district" placeholder="区" disabled />
              <input class="address-input" [(ngModel)]="this.thirdProductData.address" placeholder="详细地址" nz-input
                autocomplete="off" name="address" maxlength='100' disabled />
            </nz-form-control>
          </nz-form-item>
          <nz-form-item nzFlex style="margin-bottom: 10px;">
            <nz-form-label nzRequired [nzNoColon]='true'>交通指南</nz-form-label>
            <nz-form-control>
              <app-product-editor1 #editor1></app-product-editor1>
            </nz-form-control>
          </nz-form-item>

          <nz-form-item nzFlex style="margin-bottom: 10px;">
            <nz-form-label nzRequired [nzNoColon]='true'>预订须知</nz-form-label>
            <nz-form-control>
              <app-product-editor2 #editor2></app-product-editor2>
            </nz-form-control>
          </nz-form-item>

          <nz-form-item nzFlex>
            <nz-form-label nzRequired [nzNoColon]='true'>景区介绍</nz-form-label>
            <nz-form-control>
              <app-product-editor3 #editor3></app-product-editor3>
            </nz-form-control>
          </nz-form-item>
        </div>
      </form>
    </div>
  </div>
</div>